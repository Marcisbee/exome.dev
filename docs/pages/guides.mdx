import { LiveTodoReactGuides } from "../components/live/todo-react-guides";

# Guides

## Folder structure
There are no rules on how to structure stores, but working with exome for couple of years now across multiple very large projects I can make some suggestions:

1. Try to make 1 file per store;
2. Try to name store files ending with `*.store.ts`, `*.store.js`;

```txt
user.store.ts
user-list.store.ts
```

3. Try to name stores ending with `*Store`;
    - It's easy to confuse store names with component names later.

```ts
class UserStore extends Exome {}
class UserListStore extends Exome {}
```

4. Try to base all logic inside actions instead of components;
    - It's way easier to manage data flow via actions while UI frameworks only display data, UI and trigger user events.
5. If you're going with `features` folder structure, then put store there too:

```txt
my-project/
├── features/
│   └── jsonlogic-editor/
│       ├── jsonlogic-editor.component.tsx
│       └── jsonlogic-editor.store.ts
│   ...
```

6. If you're have different folder structure, then put stores together:

```txt
my-project/
├── components/
│   ...
├── stores/
│   ├── settings.store.ts
│   └── user.store.ts
│   ...
```

Now you may not follow these suggestions and maybe find some better way to handle things, might as well [open issue](https://github.com/Marcisbee/exome/issues) revealing that info with everyone.

## Nested stores
{/* @TODO use different example so that it doesn't double todo app */}
Exome is made to handle deeply nested stores with ease.

Before exome there is usually one single store, that contains everything and any mutation to it, requires data to be repeater-drilled. But not in exome.

Think of exome as atomic store. You can have as many stores as needed that each work just for themselves.

Lets start with simple todo example. First we need store that handles single todo:

```ts twoslash [todo.store.ts] filename="todo.store.ts"
import { Exome } from "exome"

export class TodoStore extends Exome {
  public completed = false

  constructor(
    public content: string
  ) {
    super()
  }

  public toggle() {
    this.completed = !this.completed
  }
}
```

We created `completed` property with default value `false`.

However `content` we want to define every time we create a new todo so we'll do that in constructor.

And we need some way to update `comleted` status so that will be handled in `toggle` action.

Next we need some store that handles list of todos:

```ts twoslash [todo-list.store.ts] filename="todo-list.store.ts"
// @noErrors
import { Exome } from "exome"
import { TodoStore } from "./todo.store.ts"

export class TodoListStore extends Exome {
  public todos: TodoStore[] = []

  public addTodo(todo: TodoStore) {
    this.todos.push(todo)
  }
}
```

Here we have a store (`TodoListStore`) that contains other stores (`TodoStore`) in `todos` property. This is what exome was designed for.

Also we need a way to add new todo to the list, so that will be handled by `addTodo` action. This action expects already created `TodoStore` instance, but that is not a must, action can also create new `TodoStore` instance itself! I created it this way just to give extra control to dev creating a new todo item.

Ok so that's basically it, we created all that is needed for this app to work. Now lets create UI for this app.

I'll use react for this example, but you can chose any other integration.

```tsx twoslash [app.tsx] filename="app-guides-nesting-todo.tsx"
// @noErrors
import { getExomeId } from "exome";
import { useStore } from "exome/react"
import { TodoStore } from "./todo.store.ts"
import { TodoListStore } from "./todo-list.store.ts"

const todoListStore = new TodoListStore()

// Fill store with some demo values
todoListStore.addTodo(new TodoStore("Throw the trash out"));
todoListStore.addTodo(new TodoStore("Work out"));

function Todo({ todo }: { todo: TodoStore }) {
  const { completed, content, toggle } = useStore(todo)

  return (
    <label>
      <input
        type="checkbox"
        onChange={toggle}
        checked={completed}
      />
      {content}
    </label>
  )
}

function TodoList() {
  const { todos, addTodo } = useStore(todoListStore)

  return (
    <ul>
      {todos.map((todo) => (
        <li key={getExomeId(todo)}>
          <Todo
            todo={todo}
          />
        </li>
      ))}
    </ul>
  )
}
```

<div className="live-code-preview">
<span>Live preview</span>
<LiveTodoReactGuides />
</div>

Now we have fully functional todo store. You may notice that this app is not really complete as it's missing a way to add, delete and sort todos. This is covered in todo app tutorial.

## Testing
@TODO

## Devtools
@TODO

## Custom integration
@TODO
